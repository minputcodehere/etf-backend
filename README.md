# ETF Backend API Service

## ğŸ“Š é …ç›®æ¦‚è¿°

ETF è‚¡ç¥¨æ•¸æ“šå¾Œç«¯ API æœå‹™ - å°ˆç‚ºå°è‚¡ ETF å³æ™‚æ•¸æ“šæä¾›çš„é«˜æ€§èƒ½ RESTful APIï¼Œæ•´åˆ Yahoo Finance æ•¸æ“šæºï¼Œæä¾›ç·©å­˜æ©Ÿåˆ¶å’Œå¯é çš„è‚¡ç¥¨æ•¸æ“šæœå‹™ã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### æ•¸æ“šæºæ•´åˆ
- **Yahoo Finance API**ï¼šå³æ™‚è‚¡ç¥¨æ•¸æ“šç²å–
- **æ”¯æ´ ETF**ï¼š0056.TW, 00878.TW, 00919.TW, 0050.TW, 006208.TW
- **å¤šæ™‚é–“ç¯„åœ**ï¼š3å¤©ã€1é€±ã€1æœˆã€3æœˆã€6æœˆã€1å¹´æ­·å²æ•¸æ“š

### ä¸»è¦ç‰¹æ€§
- **âš¡ é«˜æ€§èƒ½ç·©å­˜**ï¼š30ç§’ TTL ç·©å­˜æ©Ÿåˆ¶ï¼Œæ¸›å°‘ API èª¿ç”¨
- **ğŸš€ å¿«é€Ÿå•Ÿå‹•**ï¼šæ‡‰ç”¨å•Ÿå‹•æ™‚é ç†±ç·©å­˜
- **ğŸ”„ è‡ªå‹•é‡è©¦**ï¼šéŒ¯èª¤è™•ç†å’Œé‡è©¦æ©Ÿåˆ¶
- **ğŸ“Š RESTful API**ï¼šæ¨™æº–åŒ– REST ç«¯é»è¨­è¨ˆ
- **ğŸ›¡ï¸ CORS æ”¯æ´**ï¼šè·¨åŸŸè«‹æ±‚è™•ç†

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### æ ¸å¿ƒæŠ€è¡“æ£§
- **Node.js** - æœå‹™å™¨é‹è¡Œç’°å¢ƒ
- **Express.js** - Web æ‡‰ç”¨æ¡†æ¶
- **node-cache** - å…§å­˜ç·©å­˜ç³»çµ±
- **Axios** - HTTP è«‹æ±‚å®¢æˆ¶ç«¯
- **dotenv** - ç’°å¢ƒè®Šé‡ç®¡ç†
- **cors** - è·¨åŸŸè³‡æºå…±äº«

### é …ç›®çµæ§‹
```
src/
â”œâ”€â”€ app.js              # Express æ‡‰ç”¨é…ç½®
â”œâ”€â”€ server.js           # æœå‹™å™¨å•Ÿå‹•å…¥å£
â”œâ”€â”€ routes/             # API è·¯ç”±
â”‚   â””â”€â”€ stockRoutes.js  # è‚¡ç¥¨æ•¸æ“šè·¯ç”±
â””â”€â”€ services/           # æ¥­å‹™é‚è¼¯æœå‹™
    â””â”€â”€ stockService.js # è‚¡ç¥¨æ•¸æ“šæœå‹™
```

## ğŸ› ï¸ å®‰è£èˆ‡é‹è¡Œ

### ç’°å¢ƒè¦æ±‚
- Node.js >= 16.0.0
- npm >= 8.0.0

### å®‰è£æ­¥é©Ÿ
```bash
# å…‹éš†é …ç›®
git clone git@github.com:minputcodehere/etf-backend.git
cd etf-backend

# å®‰è£ä¾è³´
npm install

# å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
npm run dev
```

### å¯ç”¨è…³æœ¬
```bash
npm start       # å•Ÿå‹•ç”Ÿç”¢æœå‹™å™¨
npm run dev     # å•Ÿå‹•é–‹ç™¼æœå‹™å™¨ (with nodemon)
```

## ğŸ”— API ç«¯é»

### å¥åº·æª¢æŸ¥
```http
GET /api/health
```
**éŸ¿æ‡‰ç¯„ä¾‹ï¼š**
```json
{
  "status": "OK",
  "timestamp": "2025-08-09T12:00:00.000Z",
  "uptime": 3600
}
```

### ç²å–è‚¡ç¥¨æ•¸æ“š
```http
GET /api/stock/{symbol}?range={period}
```

**åƒæ•¸èªªæ˜ï¼š**
- `symbol`: è‚¡ç¥¨ä»£è™Ÿ (ä¾‹: 0056.TW, 00878.TW, 00919.TW, 0050.TW, 006208.TW)
- `range`: æ™‚é–“ç¯„åœ (3d, 1wk, 1mo, 3mo, 6mo, 1y)

**éŸ¿æ‡‰ç¯„ä¾‹ï¼š**
```json
{
  "symbol": "0056.TW",
  "meta": {
    "currency": "TWD",
    "symbol": "0056.TW",
    "exchangeName": "TAI",
    "instrumentType": "ETF",
    "firstTradeDate": 1167609600,
    "regularMarketTime": 1723190400,
    "gmtoffset": 28800,
    "timezone": "CST",
    "exchangeTimezoneName": "Asia/Taipei"
  },
  "timestamp": [1723104000, 1723190400, ...],
  "indicators": {
    "quote": [{
      "volume": [2843924, 3456789, ...],
      "open": [37.45, 37.52, ...],
      "high": [37.65, 37.78, ...],
      "low": [37.32, 37.41, ...],
      "close": [37.58, 37.69, ...]
    }]
  }
}
```

### ç²å–æ”¯æ´çš„è‚¡ç¥¨åˆ—è¡¨
```http
GET /api/supported-symbols
```

**éŸ¿æ‡‰ç¯„ä¾‹ï¼š**
```json
{
  "symbols": ["0056.TW", "00878.TW", "00919.TW", "0050.TW", "006208.TW"]
}
```

## âš™ï¸ ç’°å¢ƒé…ç½®

### ç’°å¢ƒè®Šæ•¸
å‰µå»º `.env` æ–‡ä»¶ï¼š
```env
PORT=3001
NODE_ENV=development
```

### é è¨­é…ç½®
- **æœå‹™åŸ è™Ÿ**: 3001
- **ç·©å­˜ TTL**: 30ç§’
- **æ”¯æ´çš„è‚¡ç¥¨**: å°è‚¡ ETF (0056, 00878, 00919, 0050, 006208)

## ğŸ”§ ç·©å­˜æ©Ÿåˆ¶

### ç·©å­˜ç­–ç•¥
- **å…§å­˜ç·©å­˜**: ä½¿ç”¨ node-cache é€²è¡Œé«˜é€Ÿå…§å­˜ç·©å­˜
- **TTL è¨­ç½®**: 30ç§’éæœŸæ™‚é–“ï¼Œå¹³è¡¡æ•¸æ“šæ–°é®®åº¦å’Œæ€§èƒ½
- **ç·©å­˜éµ**: `{symbol}_{range}` æ ¼å¼
- **é ç†±æ©Ÿåˆ¶**: æ‡‰ç”¨å•Ÿå‹•æ™‚é å…ˆè¼‰å…¥ 1å¹´æ•¸æ“š

### ç·©å­˜æµç¨‹
```
è«‹æ±‚ â†’ æª¢æŸ¥ç·©å­˜ â†’ ç·©å­˜å‘½ä¸­ï¼Ÿ â†’ è¿”å›æ•¸æ“š
                    â†“ å¦
              èª¿ç”¨ Yahoo API â†’ å­˜å…¥ç·©å­˜ â†’ è¿”å›æ•¸æ“š
```

## ğŸ“¦ ä¸»è¦ä¾è³´

| ä¾è³´åŒ… | ç‰ˆæœ¬ | ç”¨é€” |
|--------|------|------|
| express | ^4.18.2 | Web æ¡†æ¶ |
| axios | ^1.6.0 | HTTP å®¢æˆ¶ç«¯ |
| node-cache | ^5.1.2 | å…§å­˜ç·©å­˜ |
| cors | ^2.8.5 | è·¨åŸŸè™•ç† |
| dotenv | ^17.2.1 | ç’°å¢ƒè®Šæ•¸ |
| nodemon | ^3.0.2 | é–‹ç™¼ç†±é‡è¼‰ |

## ğŸš€ éƒ¨ç½²

### Docker éƒ¨ç½² (å¯é¸)
```dockerfile
FROM node:16-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY . .
EXPOSE 3001
CMD ["npm", "start"]
```

### PM2 éƒ¨ç½²
```bash
npm install -g pm2
pm2 start src/server.js --name etf-backend
```

## ğŸ” ç›£æ§èˆ‡æ—¥èªŒ

### å¥åº·æª¢æŸ¥ç«¯é»
- ç«¯é»: `/api/health`
- ç”¨é€”: ç›£æ§æœå‹™ç‹€æ…‹ã€é‹è¡Œæ™‚é–“

### æ—¥èªŒè¼¸å‡º
- æœå‹™å•Ÿå‹•æ—¥èªŒ
- API è«‹æ±‚éŒ¯èª¤æ—¥èªŒ
- ç·©å­˜æ“ä½œæ—¥èªŒ

## ğŸ¤ è²¢ç»æŒ‡å—

æ­¡è¿æäº¤ Issue å’Œ Pull Requestã€‚åœ¨æäº¤ä»£ç¢¼å‰ï¼Œè«‹ç¢ºä¿ï¼š
- éµå¾ª Node.js æœ€ä½³å¯¦è¸
- æ·»åŠ é©ç•¶çš„éŒ¯èª¤è™•ç†
- æ›´æ–°ç›¸é—œæ–‡æª”

## ğŸ“„ æˆæ¬Š

MIT License

---

## ğŸ”— ç›¸é—œé …ç›®

- **å‰ç«¯é …ç›®**: [ETF Frontend Dashboard](https://github.com/minputcodehere/etf-frontend)
- **æ•¸æ“šæº**: Yahoo Finance API